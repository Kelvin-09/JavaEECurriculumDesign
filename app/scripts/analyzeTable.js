$(function(){function a(a){var b,c,d,e,f={},g=[];switch(a.question.questionType){case 8:b=a.question,c=b.matrixRowTitleArr,d=b.matrixColTitleArr,e=a.osms,$.each(c,function(a){g[a]=[],$.each(d,function(b){g[a][b]=[]})}),$.each(e,function(a,b){g[b.matrixRowIndex][b.matrixColIndex][b.matrixSelectIndex]=b.count}),f.count=a.count,f.title=b.title,f.questionType=b.questionType,f.matrixRowTitleArr=b.matrixRowTitleArr,f.matrixColTitleArr=b.matrixColTitleArr,f.matrixSelectOptionArr=b.matrixSelectOptionArr,f.dataMatrix=g;break;default:alert("接收到的数据格式错误！")}return f}function b(a){var b=["bg-blue ","bg-aqua ","bg-teal ","bg-olive ","bg-green ","bg-lime ","bg-yellow ","bg-orange ","bg-red ","bg-maroon ","bg-fuchsia ","bg-purple "],c=Math.random()*b.length;return b.slice(c).concat(b.slice(0,c))}function c(a,b){var c,d,e=[];return c=$(f),$.each(a,function(a,c){d=$(h.replace(/\{0\}/,c)),d.find(".legend-box").addClass(b[a]),e.push(d)}),$(i).append(c,$(g).append(e))}function d(a){var b,c,d={};return b=a.slice(),c=a.slice().sort(function(a,b){return a-b}),$.each(c,function(a,c){var e=b.indexOf(c);b[e]=void 0,d[c]?d[c].push(e):d[c]=[e]}),d}function e(a){var e,f,g,h,o,p,q=[];f=a.count,e=a.dataMatrix,g=a.matrixRowTitleArr,h=a.matrixColTitleArr,o=a.matrixSelectOptionArr,p=b(),q.push(c(a.matrixSelectOptionArr,p)),$.each(e,function(a,b){var c,e,r=[];c=$(j).text(g[a]),$.each(b,function(a,b){var c,e,g,j=[],l=0;c=$(k).text(h[a]),g=d(b),$.each(g,function(a,b){var c=[],d=$(n).css({width:(a-l)/f*100+"%"});l=a,$.each(b,function(a,b){c.push(o[b]),d.addClass(p[b])}),d.text(c.join("&")+" : "+a+"人"),j.push(d)}),e=$(m).find(".progress").append(j),r.push($(i).append(c,e))}),e=$(i).append(c,$(l).append(r)),q.push(e)}),$("#chartContent").append(q)}var f='<label class="control-label col-sm-2">图例</label>',g='<div class="col-sm-10"></div>',h='<div class="legend-container"><div class="legend-box"></div><label class="legend-label">{0}</label></div>',i='<div class="form-group"></div>',j='<label class="control-label col-sm-2 col-lg-1"></label>',k='<label class="control-label col-xs-2 col-lg-1"></label>',l='<div class="col-sm-10 col-lg-11"></div>',m='<div class="col-xs-10  col-lg-11"><div class="progress"></div></div>',n='<div class="progress-bar"></div>';$.ajax({url:"data/analyzeDataChart_02.json",type:"GET",dataType:"json",success:function(b){e(a(b[0]))},error:function(a){alert("Can't get data")}})});